# 讲座助手启动说明

## 问题诊断

您遇到的"按了open没反应"问题主要是因为：

1. **缺少Node.js环境** - 系统未安装Node.js
2. **缺少环境变量配置** - 没有配置Soniox API密钥
3. **代码错误处理不完善** - 缺少错误提示

## 解决步骤

### 1. 安装Node.js

请访问 [Node.js官网](https://nodejs.org/) 下载并安装最新版本的Node.js。

安装完成后，在命令行中运行以下命令验证：
```bash
node --version
npm --version
```

### 2. 配置环境变量

在 `server` 目录下创建 `.env` 文件：

```bash
# Soniox API配置
SONIOX_API_KEY=your_api_key_here

# 服务器配置
PORT=4350
ROOT_DIR=./storage

# 音频配置
SAVE_AUDIO=true
DO_TRANSLATE=true
TARGET_LANGUAGE=zh
LANGUAGE_HINTS=ja,en
MODEL=stt-rt-preview
ENABLE_ENDPOINT_DETECTION=true
SILENCE_FINALIZE_MS=2000
MAX_SEGMENT_SEC=10

# 课程配置
COURSE_NAME=course-default
```

**重要：** 请将 `your_api_key_here` 替换为您的实际Soniox API密钥。

### 3. 安装依赖

在 `server` 目录下运行：
```bash
npm install
```

### 4. 启动服务器

```bash
npm run dev
```

### 5. 访问应用

打开浏览器访问：http://localhost:4350

## 功能说明

### 实时翻译功能

根据Soniox官方文档，项目已更新为支持：

- **单向翻译**：将所有语音翻译为中文
- **语言识别**：自动识别日语和英语
- **说话人分离**：区分不同说话人
- **端点检测**：自动检测语音结束

### 使用方法

1. 点击 "🎙️ Start" 按钮开始录音
2. 系统会请求麦克风权限
3. 开始说话，系统会实时显示：
   - **JA**：日语原文
   - **ZH**：中文翻译
4. 点击 "⏹ Stop" 按钮停止录音

### 错误处理

现在系统包含完善的错误处理：

- WebSocket连接失败时会显示错误提示
- Soniox API错误会显示具体错误信息
- 麦克风权限被拒绝时会显示相应提示

## 故障排除

### 如果仍然无法工作

1. **检查控制台**：打开浏览器开发者工具查看控制台错误
2. **检查API密钥**：确保Soniox API密钥正确配置
3. **检查网络**：确保能访问 `wss://stt-rt.soniox.com`
4. **检查端口**：确保4350端口未被占用

### 常见错误

- `Missing SONIOX_API_KEY`：需要配置API密钥
- `WebSocket connection failed`：检查网络连接
- `Permission denied`：需要允许麦克风权限

## 导出功能

录音完成后，可以访问 http://localhost:4350/export/srt 下载SRT字幕文件。

